---
title: "biopixR - Tools for Biological Image Processing and Analysis"
author: "Tim Brauckhoff"
date: "`r Sys.Date()`"
output:
  pdf_document:
    toc: yes
  html_document:
    toc: yes
    number_sections: yes
bibliography: lib-vig.bib
---

<style>
body {
text-align: justify}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE,
  message = FALSE,
  cache = FALSE,
  comment = NA,
  verbose = TRUE,
  fig.width = 5,
  fig.height = 5
)
original_options <- options()
options(digits = 3)

library(biopixR)
library(foodwebr)
```

\pagebreak

```{r, echo=FALSE, fig.align='center'}
knitr::include_graphics("figures/fig0_logo.png")
```


# Aims of the `biopixR` package

# Introduction to Object Quantification in Biological Images

## Techniques in Bioimage Informatics for Object Detection

 **Segmentation and Classification**

# Concepts and Methods

## Development, Implementation and Installation

```{r, eval=FALSE}
foodweb(biopixR::imgPipe) |> plot()
```

```{r, echo=FALSE, fig.pos='hold', fig.align='center', out.width="99%"}
knitr::include_graphics("figures/fig4_dependency.png")
```

### Version Control and Continous Integration

### Naming Convention and Literate Programming

`biopixR` is an `R` ($\ge$ 4.2.0) package, designed using the S3 object system. S3 incorporates features of object-oriented programming while simplifying development through the use of naming conventions @Brito2008

Typically, functions and parameters are written using underscore separation, a common style in R packages [@Rasmus2012]. However, for easier differentiation this convention was broken and only used for the variables and parameters introduced in the package. By the naming convention of @Rasmus2012 the functions of the `biopixR` package follow the **lowerCamelCase** convention with an exception for interactive function using the **underscore_separated** style (e.g. `interactive_objectDetection()`).

For improving code format`styler` - @Mueller2017

Literate programming, a concept proposed by @Knuth1984, integrates source code and documentation within a single file. Markup conventions (e.g., ‘#’) dictate how to typeset the documentation, producing outputs in typesetting languages such as Markdown.

The `roxygen2`, `rmarkdown`, and `knitr` packages were employed to write the
documentation inline with the code for the `biopixR` package.

https://www.datacamp.com/tutorial/r-objects-and-classes
https://academic.oup.com/comjnl/article/27/2/97/343244
https://content.e-bookshelf.de/media/reading/L-15652-9b3cab7f3d.pdf
https://projecteuclid.org/journals/statistical-science/volume-29/issue-2/Object-Oriented-Programming-Functional-Programming-and-R/10.1214/13-STS452.full
https://styler.r-lib.org/articles/styler.html
https://style.tidyverse.org/
https://github.com/r-lib/styler
https://adv-r.hadley.nz/s3.html


### Installation of the `biopixR` package

The ongoing developments will be consistently updated in the GitHub repository.
Consequently, the latest developer version of the `biopixR` package can be
accessed and downloaded directly from the repository using the `devtools`
package.

```{r, eval=FALSE}
# Install the 'devtools' package from CRAN.
# 'devtools' is required for installing R packages directly from GitHub repositories.
install.packages("devtools")

# Install the 'biopixR' package from a GitHub repository.
# 'install_github' is a function in 'devtools' that is used to install R packages hosted on GitHub.
# The argument "Brauckhoff/biopixR" specifies the GitHub username/repo of the package.
devtools::install_github("Brauckhoff/biopixR")
```

The `biopixR` package is available on The **C**omprehensive **R** **A**rchive
**N**etwork (CRAN), which can be accessed at
[https://CRAN.R-project.org/package=biopixR]. CRAN employs rigorous testing
procedures to ensure that the package can be downloaded and built on all major
operating systems. Additionally, it validates the examples and documentation
through the `R CMD check`. In order to utilize the `biopixR` package, it is
first necessary to install R (version 4.2.0 or higher) and then to execute the
following code:

```{r, eval=FALSE}
# Install the 'biopixR' package from the Comprehensive R Archive Network (CRAN).
install.packages("biopixR")
```

The results of the R CMD check conducted by CRAN can be accessed via the
following link:
[https://cran.r-project.org/web/checks/check_results_biopixR.html]

### Unit Testing of the `biopixR` Package

## Quantitative Analysis of Biological Images with Focus on Microbeads

### Quantitative Assessment of Microbeads



### Why is there a need for the `biopixR` package?

### Software for Quantitative Evaluation of Biological Images

```{r eval=FALSE}
par(mfrow = c(1, 2))

img <- importImage("figures/tim_242602_c_s6c1+2+3m3.tif")
plot(img)
text(c(50), c(60), c("A"), col = "darkred", cex = 6)

img_g <- img[, , , 2]
cimg_g <- as.cimg(img_g)

detected <-
  objectDetection(cimg_g,
                  method = 'edge',
                  alpha = 1.3,
                  sigma = 0)
colored_objects <-
  changePixelColor(z,
                   r$coordinates,
                   color = factor(r$coordinates$value),
                   vis = FALSE)

plot(colored_objects)
text(c(50), c(60), c("B"), col = "darkred", cex = 6)
```

```{r, fig.pos='hold', fig.align='center', out.width="99%"}
knitr::include_graphics("figures/fig1_DSB_analysis.png")
```

### Principles in Bioimage Informatics

## Functions for Quantitative Data Analysis in `biopixR`

### Quantification of Microbeads with Function of the `biopixR` package

### `importImage()` Importing Images into the R Environment

### `objectDetection()` Function to detect Microbeads in an Image


```{r}

```


### Dealing with Autofluorescence and Clotting with `sizeFilter()` and `proximityFilter()`

### Interpretation with `resultAnalytics()`

## Batch proccesing Functions within the `biopixR` package

### `imgPipe()` and `scanDir()`

## Functions for Droplet Analysis

### Dealing with discontinous edges

### `fillLineGaps()` - 

## Shape, Texture and unsupervised Machine Learning

### `shapeFeatures()` - Object clustering based on shape features

```{r}
library(imager)

circ <- importImage("figures/fig3_analysis_circ.png")
circ <- grayscale(circ)

test <- shapeFeatures(circ) 

```

```{r, echo=FALSE}
seven <- test[6, 2:12]
six <- test[7, 2:12]

test[6, 2:12] <- six
test[7, 2:12] <- seven
```

```{r, fig.pos='hold', fig.align='center', out.width="79%"}
knitr::include_graphics("figures/fig2_circularity.png")
```

### `HaralickCluster()` - Image classification based on texture features


## Helper Functions of the `biopixR` Package

- `interpolatePixels()`
- `adaptiveInterpolation()`
- `edgeDetection()`
- `changePixelColor()`

# Discussion

# Summary and Conclusion



\pagebreak

```{r}
sessionInfo()
```

\pagebreak

# References
